@{
    ViewBag.Title = "InsertDone";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@using (Html.BeginForm("InsertDone", "Prs", FormMethod.Post, new { @class = "j-forms", @id = "j-forms", @enctype = "multipart/form-data" }))
{
<div class="widget-wrap" style="height:300px">
    <div class="alert alert-success"><h5>Prs Genetated Successfully</h5></div>
    <div class="row">
        <div class="col-sm-3">
            <h4>Prs No</h4>
        </div>
        <div class="col-sm-4">
            <div class="form-group">
                @Html.Label(" ", new { @id = "lblDocumentNo", @for = "DocumentNo", @class = "label-bold" })
                @Html.Hidden("hdnDocumentId")
            </div> 
        </div>
        <div class="col-sm-2">
            <button type="button" onclick="return ViewReport();" class="btn btn-info">
            @*<button onclick="return ViewReport(( @ModuleHelper.Prs,$('#hdnDocumentId').val());" class="btn btn-info"></button>
            <button onclick="return ViewReport(@ModuleHelper.Prs,$('#hdnDocumentId').val());" class="btn btn-info">*@
                <i class="fa fa-eye"></i>
            </button>
        </div>
    </div>
    <div class="row" id="dvBillDetails" style="display:none">
        <div class="col-sm-3">
            <h4>Bill No</h4>
        </div>
        <div class="col-sm-4">
            <div class="form-group">
                @Html.Label(" ", new { @id = "lblDocumentNo2", @for = "DocumentNo2", @class = "label-bold" })
                @Html.Hidden("hdnDocumentId2")
            </div>
        </div>
        <div class="col-sm-2">
            <button type="button" onclick="return ViewBillReport()" class="btn btn-info">
                <i class="fa fa-eye"></i>
            </button>
        </div>
    </div>

    <div class="row" id="dveWayBillDetails" style="display:none">
        <div class="col-sm-3">
            <h4>Consolidate eWay Bill No</h4>
        </div>
        <div class="col-sm-4">
            <div class="form-group">
                @Html.Label(" ", new { @id = "lblDocumentNo3", @for = "DocumentNo3", @class = "label-bold" })
                @Html.Hidden("hdnDocumentId3")
            </div>
        </div>
        <div class="col-sm-2" id="dveWayBillDetailsLink">

        </div>
    </div>

    <div id="dvUploadFile">
        <div class="row">
            <div class="col-sm-4">
                <div class="form-group">
                    File
                    <div class="input prepend-big-btn">
                        <label class="icon-right" for="prepend-big-btn">
                            <i class="fa fa-download"></i>
                        </label>
                        <div class="file-button">
                            Browse
                            @Html.TextBox("fuFileName", null, new { @class = "form-control", @id = "fuFileName", @type = "file", @onchange = "$('#prepend-big-btn').val($(this).val())" })
                            @Html.Hidden("hdnFileName", new { @id = "hdnFileName" })
                            @Html.Hidden("hdnDocumentType", new { @id = "hdnDocumentType" })
                        </div>
                        <input class="form-control" type="text" id="prepend-big-btn" readonly="" placeholder="no file selected">
                    </div>

                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-4">
                <button type="submit" class="btn btn-success primary-btn" tabindex="3">Upload</button>
            </div>

        </div>

    </div>
</div>
}
<script>
    $(document).ready(function () {
        ruleMasterUrl = '@Url.Action("", "Rules", new { Area = "Master" })';
        SetPageLoad('Prs', 'Insert Done', '', 'Go To Insert', '@Url.Action("Insert")');
        lblDocumentNo = $('#lblDocumentNo');
        hdnDocumentId = $('#hdnDocumentId');
        lblDocumentNo2 = $('#lblDocumentNo2');
        hdnDocumentId2 = $('#hdnDocumentId2');
        lblDocumentNo3 = $('#lblDocumentNo3');
        hdnDocumentId3 = $('#hdnDocumentId3');


        dvUploadFile = $('#dvUploadFile');
        hdnDocumentType = $('#hdnDocumentType');
        hdnDocumentType.val('PRS');
        lblDocumentNo2.html(GetUrlValue()["documentNo2"]);
        hdnDocumentId2.val(GetUrlValue()["documentId2"]);
        $('#dvBillDetails').showHide(parseInt(hdnDocumentId2.val()) > 0);
        lblDocumentNo.html(GetUrlValue()["documentNo"]);
        hdnDocumentId.val(GetUrlValue()["documentId"]);

        lblDocumentNo3.html(GetUrlValue()["documentNo3"]);
        hdnDocumentId3.val(GetUrlValue()["documentId3"]);
        baseUrl = '@Url.Action("", "Docket", new { Area = "Operation" })';

        if (hdnDocumentId3.val() != "") {
            $('#dveWayBillDetails').showHide(parseInt(hdnDocumentId3.val()) > 0);

            // Assuming you have the 'tripNo' variable defined
            var tripNo = hdnDocumentId3.val();
            // Construct the base URL and action name
            var actionName = 'DownloadConsolidateeWayBillPdf';

            // Construct the complete URL with the tripNo parameter
            var completeUrl = baseUrl + '/' + actionName + '?tripNo=' + tripNo;

            // Create the link element
            var link = $('<a>', {
                class: 'btn btn-primary',
                href: completeUrl
            });

            // Create the icon element
            var icon = $('<span>', {
                class: 'glyphicon glyphicon-print'
            });

            // Append the icon element to the link element
            link.append(icon);

            // Append the link element to a target element (e.g., a container in your HTML)
            $('#dveWayBillDetailsLink').append(link);
        }
        var request1 = { moduleId: 1, ruleId: 74 };
        AjaxRequestWithPostAndJson(ruleMasterUrl + '/GetModuleRuleByIdAndRuleId', JSON.stringify(request1), function (result) {
            if (result == "N") { dvUploadFile.hide(); }
        }, ErrorFunction, false);

    });

    function ViewReport() {
        return ShowViewPrint('@ModuleHelper.Prs',hdnDocumentId.val());
    }
    function ViewBillReport() {
        var prmList = [{ Name: "BillId", Value: hdnDocumentId2.val() }];
        var reportInfo = { PrmList: prmList, Name: 'VendorBillDetailViewPrint', Description: 'Vehicle Hire Bill Entry View' };
        return ShowReport(reportInfo);
    }
</script>

