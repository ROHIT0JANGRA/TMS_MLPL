@using CodeLock.Models
@model CreditDebitVoucher
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@using (Html.BeginForm("CreditDebitVoucher", "Accounts", FormMethod.Post, new { @class = "j-forms", enctype = "multipart/form-data" }))
{
    <div class="widget-wrap">
        @Html.HiddenFor(model => model.CompanyId, new { @id = "hdnCompanyId", @Value = @SessionUtility.CompanyId })
        @Html.AntiForgeryToken()
        <div class="row">
            <div class="col-sm-8">
                <div class="form-group">
                    <div class="inline-group">
                        @Html.LabelFor(model => model.VoucherType, new { @class = "label" })
                        <label class="radio">
                            @Html.RadioButtonFor(model => model.VoucherType, "1", new { @id = "rdManualDebitVoucher", @tabindex = "0", @checked = "checked" })
                            <i></i>
                            @Html.LabelFor(model => model.VoucherType, "Manual Debit Voucher", new { @for = "rdManualDebitVoucher", @class = "label-bold" })
                        </label>
                        <label class="radio">
                            @Html.RadioButtonFor(model => model.VoucherType, "2", new { @id = "rdManualCreditVoucher", @tabindex = "0" })
                            <i></i>
                            @Html.LabelFor(model => model.VoucherType, "Manual Credit Voucher", new { @for = "rdManualCreditVoucher", @class = "label-bold" })
                        </label>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(model => model.VoucherNo, new { @class = "label" })
                    <div class="system-label">
                        @Html.LabelFor(model => model.VoucherNo, "<System Generated>")
                    </div>
                </div>
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.Partial("DateTimePicker", new DateTimePicker() { FieldName = "VoucherDate", FieldCaption = DataAnnotationHelper.GetDisplayName(Model, m => m.VoucherDate), IsRequired = true, AllowFutureDate = false, AllowPastDate = true })
                </div>
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(m => m.ManualNo, new { @class = "label" })
                    <div class="input">
                        @Html.TextBoxFor(m => m.ManualNo, new { @class = "form-control" })
                    </div>
                </div>
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(model => model.BusinessTypeId, new { @class = "label" })
                    <div class="select">
                        @Html.DropDownListFor(model => model.BusinessTypeId, new SelectList(ViewBag.BusinessTypeList, "Value", "Name"), new { @class = "form-control", @id = "ddlBusinessTypeId" })
                        <i></i>
                    </div>
                    @Html.ValidationMessageFor(model => model.BusinessTypeId)
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(model => model.Remarks, new { @class = "label" })
                    <div class="input">
                        @Html.TextBoxFor(model => model.Remarks, new { @class = "form-control" })
                    </div>
                    @Html.ValidationMessageFor(model => model.Remarks)
                </div>
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(m => m.ReferenceNo, new { @class = "label" })
                    <div class="input">
                        @Html.TextBoxFor(m => m.ReferenceNo, new { @class = "form-control" })
                    </div>
                    @Html.ValidationMessageFor(model => model.ReferenceNo)
                </div>
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(model => model.AccountingLocationId, new { @class = "label" })
                    <div class="input">
                        @Html.HiddenFor(model => model.AccountingLocationId, new { @id = "hdnAccountingLocationId", @Value = @SessionUtility.LoginLocationId })
                        @Html.TextBoxFor(model => model.AccountingLocationCode, new { @class = "form-control text-complete text-complete-html", @id = "txtAccountingLocationCode", @Value = @SessionUtility.LoginLocationCode })
                    </div>
                    @Html.ValidationMessageFor(model => model.AccountingLocationCode)
                </div>
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(m => m.GstTinNo, new { @class = "label" })
                    <div class="clearfix">
                        @Html.LabelFor(m => m.GstTinNo, " ", new { @id = "lblCompanyGstTinNo", @class = "label-bold" })
                        @Html.HiddenFor(model => model.GstTinNo, new { @id = "hdnGstTinNo" })
                        @Html.HiddenFor(model => model.CompanyGstId, new { @id = "hdnCompanyGstId" })
                        @Html.HiddenFor(model => model.CompanyGstStateId, new { @id = "hdnCompanyGstStateId" })
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12">
                <div class="form-group">
                    <div class="inline-group">
                        @Html.Label(" ", new { @class = "label" })
                        <label class="radio">
                            @Html.RadioButtonFor(model => model.CodeType, "2", new { @id = "rdCodeTypeCustomer", @tabindex = "0", @checked = "checked" })
                            <i></i>
                            @Html.LabelFor(model => model.CodeType, "Customer", new { @for = "rdCodeTypeCustomer" })
                        </label>
                        <label class="radio">
                            @Html.RadioButtonFor(model => model.CodeType, "3", new { @id = "rdCodeTypeVendor", @tabindex = "0" })
                            <i></i>
                            @Html.LabelFor(model => model.CodeType, "Vendor", new { @for = "rdCodeTypeVendor" })
                        </label><label class="radio">
                            @Html.RadioButtonFor(model => model.CodeType, "1", new { @id = "rdCodeTypeEmployee", @tabindex = "0" })
                            <i></i>
                            @Html.LabelFor(model => model.CodeType, "Employee", new { @for = "rdCodeTypeEmployee" })
                        </label>
                        <label class="radio">
                            @Html.RadioButtonFor(model => model.CodeType, "5", new { @id = "rdCodeTypeDriver", @tabindex = "0" })
                            <i></i>
                            @Html.LabelFor(model => model.CodeType, "Driver", new { @for = "rdCodeTypeDriver" })
                        </label>
                        <label class="radio">
                            @Html.RadioButtonFor(model => model.CodeType, "6", new { @id = "rdCodeTypeVehicle", @tabindex = "0" })
                            <i></i>
                            @Html.LabelFor(model => model.CodeType, "Vehicle", new { @for = "rdCodeTypeVehicle" })
                        </label>
                        <label class="radio">
                            @Html.RadioButtonFor(model => model.CodeType, "8", new { @id = "rdCodeTypeOther", @tabindex = "0" })
                            <i></i>
                            @Html.LabelFor(model => model.CodeType, "Other", new { @for = "rdCodeTypeOther" })
                        </label>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(model => model.CodeId, new { @class = "label" })
                    <div class="input">
                        @Html.HiddenFor(model => model.CodeId, new { @id = "hdnCodeId" })
                        @Html.TextBoxFor(model => model.Code, null, new { @class = "form-control text-complete text-complete-html", @id = "txtCode" })
                    </div>
                    @Html.ValidationMessageFor(model => model.Code)
                </div>
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.Label("", " ", new { @class = "label" })
                    <div class="clearfix">
                        @Html.Label("", " ", new { @class = "label-bold", @id = "lblCode" })
                    </div>
                </div>
            </div>
            <div class="col-sm-3" id="dvOther" style="display:none">
                <div class="form-group">
                    @Html.LabelFor(model => model.PartyName, new { @class = "label", @id = "lblPartyName" })
                    <div class="input">
                        @Html.TextBoxFor(model => model.PartyName, null, new { @class = "form-control", @id = "txtPartyName" })
                    </div>
                    @Html.ValidationMessageFor(m => m.PartyName)
                </div>
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(model => model.PartyGstId, new { @class = "label" })
                    @Html.HiddenFor(model => model.PartyGstStateId, new { @id = "hdnPartyGstStateId" })
                    <div class="select">
                        @Html.DropDownListFor(model => model.PartyGstId, Enumerable.Empty<SelectListItem>(), "Select State", new { @class = "form-control", @id = "ddlPartyGstId" })
                        <i></i>
                    </div>
                    @Html.ValidationMessageFor(model => model.PartyGstId)
                </div>
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(m => m.GstTinNo, new { @class = "label" })
                    <div class="clearfix">
                        @Html.Label("GstTinNo", " ", new { @id = "lblGstTinNo" })
                        @Html.HiddenFor(model => model.IsPartyRegistered, new { @id = "hdnIsRegistered" })
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(model => model.Narration, new { @class = "label" })
                    <div class="input">
                        @Html.TextBoxFor(model => model.Narration, null, new { @class = "form-control", @id = "txtCommanNarration" })
                    </div>
                    @Html.ValidationMessageFor(model => model.Narration)
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-3">
                <div class="form-group">
                    <label class="checkbox">
                        @Html.CheckBoxFor(m => m.IsCostCenterApplicable, new { @id = "chkIsCostCenterApplicable" })
                        <i></i>
                        @Html.LabelFor(m => m.IsCostCenterApplicable, new { @class = "label", @For = "chkIsCostCenterApplicable" })
                    </label>
                </div>
            </div>
        </div>
        <div class="row">
            <table id="dtAccountDetailList">
                <thead>
                    <tr>
                        <th>
                            @Html.DisplayNameFor(model => model.Details[0].GstExempted)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Details[0].TdsExempted)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Details[0].IsProduct)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Details[0].AccountCode)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Details[0].AccountDescription)
                        </th>
                        <th id="thCostCenterType">
                            @Html.DisplayNameFor(model => model.Details[0].CostCenterType)
                        </th>
                        <th id="thCostCenter">
                            @Html.DisplayNameFor(model => model.Details[0].CostCenterId)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Details[0].SacId)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Details[0].Units)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Details[0].Narration)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Details[0].Amount)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Details[0].Rcm)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Details[0].GstRate)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Details[0].GstAmount)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Details[0].GstCharged)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Details[0].TotalAmount)
                        </th>
                        <th style="min-width:85px">Action</th>
                    </tr>
                </thead>
                <tbody>
                    @for (int i = 0; i < Model.Details.Count; i++)
                    {
                        <tr>
                            <td>
                                <label class="checkbox">
                                    @Html.CheckBoxFor(m => Model.Details[i].GstExempted, new { @tabindex = "0", @class = "selectrow", @id = "chkGstExempted" + i, @Name = "Details[" + i.ToString() + "].GstExempted" })
                                    <i></i>
                                </label>
                            </td>
                            <td>
                                <label class="checkbox">
                                    @Html.CheckBoxFor(m => Model.Details[i].TdsExempted, new { @tabindex = "0", @class = "selectrow", @id = "chkTdsExempted" + i, @Name = "Details[" + i.ToString() + "].TdsExempted" })
                                    <i></i>
                                </label>
                            </td>
                            <td>
                                <label class="checkbox">
                                    @Html.CheckBoxFor(m => Model.Details[i].IsProduct, new { @tabindex = "0", @class = "selectrow", @id = "chkIsProduct" + i, @Name = "Details[" + i.ToString() + "].IsProduct" })
                                    <i></i>
                                </label>
                            </td>
                            <td>
                                @Html.HiddenFor(m => Model.Details[i].AccountId, new { id = "hdnAccountId" + i, @Name = "Details[" + i + "].AccountId" })
                                <div class="input">
                                    @Html.TextBoxFor(m => Model.Details[i].AccountCode, new { @class = "form-control input-small", @id = "txtAccountCode" + i.ToString() })
                                </div>
                                @Html.ValidationMessageFor(m => Model.Details[i].AccountCode)
                            </td>
                            <td>
                                @Html.LabelFor(m => Model.Details[i].AccountDescription, " ", new { @class = "label", @id = "lblAccountDescription" + i })
                            </td>
                            <td id="@("tdCostCenterType" + i)">
                                <div class="select">
                                    @Html.DropDownListFor(m => Model.Details[i].CostCenterType, new SelectList(ViewBag.CostCenterList, "Value", "Name", Model.Details[i].CostCenterType), "Select", new { @class = "form-control", @id = "ddlCostCenterType" + i.ToString() })
                                    <i></i>
                                </div>
                                @Html.ValidationMessageFor(m => Model.Details[i].CostCenterType)
                            </td>
                            <td id="@("tdCostCenter" + i)">
                                @Html.HiddenFor(m => Model.Details[i].CostCenterId, new { id = "hdnCostCenterId" + i.ToString() })
                                <div class="input">
                                    @Html.TextBoxFor(m => m.Details[i].CostCenter, new { @class = "form-control", id = "txtCostCenter" + i.ToString() })
                                    @Html.Label("", "", new { id = "lblCostCenter" + i.ToString(), @class = "lable" })
                                </div>
                                @Html.ValidationMessageFor(m => m.Details[i].CostCenter)
                            </td>
                            <td>
                                <div class="select">
                                    @Html.DropDownListFor(model => Model.Details[i].SacId, new SelectList(ViewBag.SacList, "Value", "Name", Model.Details[i].SacId), "Select", new { @class = "form-control", @id = "ddlSacId" + i.ToString() })
                                    <i></i>
                                </div>
                                @Html.ValidationMessageFor(m => Model.Details[i].SacId)
                            </td>
                            <td>
                                <div class="input">
                                    @Html.TextBoxFor(m => Model.Details[i].Units, "0", new { @class = "form-control input-small numeric", id = "txtUnits" + i.ToString(), @style = "width: 200px;" })
                                </div>
                                @Html.ValidationMessageFor(m => Model.Details[i].Units)
                            </td>
                            <td>
                                <div class="input">
                                    @Html.TextBoxFor(m => Model.Details[i].Narration, new { @class = "form-control ", id = "txtNarration" + i.ToString() })
                                </div>
                                @Html.ValidationMessageFor(m => Model.Details[i].Narration)
                            </td>
                            <td>
                                <div class="input">
                                    @Html.TextBoxFor(m => Model.Details[i].Amount, "0.00", new { @class = "form-control input-small numeric2", id = "txtAmount" + i.ToString() })
                                </div>
                                @Html.ValidationMessageFor(m => Model.Details[i].Amount)
                            </td>
                            <td>
                                @Html.LabelFor(m => Model.Details[i].Rcm, "No", new { @class = "label", @id = "lblRcm" + i })
                                @Html.HiddenFor(m => Model.Details[i].IsRcm, new { id = "hdnIsRcm" + i, @Name = "Details[" + i + "].IsRcm" })
                            </td>
                            <td>
                                <div class="input">
                                    @Html.TextBoxFor(m => Model.Details[i].GstRate, "0.00", new { @class = "form-control numeric2  input-small", id = "txtGstRate" + i.ToString() })
                                </div>
                                @Html.ValidationMessageFor(m => Model.Details[i].GstRate)
                            </td>
                            <td>
                                <div class="input">
                                    @Html.TextBoxFor(m => Model.Details[i].GstAmount, "0.00", new { @class = "form-control textlabel textlabel-small numeric2", id = "txtGstAmount" + i.ToString() })
                                </div>
                                @Html.ValidationMessageFor(m => Model.Details[i].GstAmount)
                            </td>
                            <td>
                                <div class="input">
                                    @Html.TextBoxFor(m => Model.Details[i].GstCharged, "0.00", new { @class = "form-control textlabel textlabel-small numeric2", id = "txtGstCharged" + i.ToString() })
                                </div>
                                @Html.ValidationMessageFor(m => Model.Details[i].GstCharged)
                            </td>
                            <td>
                                <div class="input">
                                    @Html.TextBoxFor(m => Model.Details[i].TotalAmount, "0.00", new { @class = "form-control textlabel textlabel-small numeric2", id = "txtTotalAmount" + i.ToString() })
                                </div>
                                @Html.ValidationMessageFor(m => Model.Details[i].TotalAmount)
                            </td>
                            <td style="min-width:85px"></td>
                        </tr>
                    }
                </tbody>
            </table>

        </div>
        <div class="row" id="dvDocumentDetails" style="display:none">
            <div class="col-sm-3">
                @Html.LabelFor(model => model.GstExemptedCategory, new { @class = "label" })
                <div class="select">
                    @Html.DropDownListFor(model => model.GstExemptedCategory, new List<SelectListItem> {
                                    new SelectListItem() {Text = "Select",Value=""},
                                    new SelectListItem() {Text = "NEWSPAPER", Value="1"},}, new { @class = "form-control", @id = "ddlGstExemptedCategory" })
                    <i></i>
                </div>
                @Html.ValidationMessageFor(model => model.GstExemptedCategory)
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(model => model.DocumentName, new { @class = "label" })
                    <div class="input prepend-big-btn">
                        <label class="icon-right" for="prepend-big-btn">
                            <i class="fa fa-download"></i>
                        </label>
                        <div class="file-button">
                            Browse
                            <input type="file" id="fuDocumentAttachment" name="Attachment" class="form-control" onchange="document.getElementById('prepend-big-btn').value = this.value;" />
                        </div>
                        <input class="form-control" type="text" id="prepend-big-btn" readonly="" placeholder="no file selected">
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(m => m.SubTotal, new { @class = "label" })
                    <div class="input">
                        @Html.TextBoxFor(model => model.SubTotal, "0.00", new { @Class = "textlabel form-control numeric2", @id = "txtSubTotal" })
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(m => m.Igst, new { @class = "label" })
                    <div class="input">
                        @Html.TextBoxFor(model => model.Igst, "0.00", new { @Class = "textlabel form-control numeric2", @id = "txtIgst" })
                    </div>
                    @Html.HiddenFor(model => model.IgstPercentage, new { @id = "hdnIgstPercentage" })
                </div>
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(m => m.Cgst, new { @class = "label" })
                    <div class="input">
                        @Html.TextBoxFor(model => model.Cgst, "0.00", new { @Class = "textlabel form-control numeric2", @id = "txtCgst" })
                    </div>
                    @Html.HiddenFor(model => model.CgstPercentage, new { @id = "hdnCgstPercentage" })
                </div>
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(m => m.Sgst, new { @class = "label" })
                    <div class="input">
                        @Html.TextBoxFor(model => model.Sgst, "0.00", new { @Class = "textlabel form-control numeric2", @id = "txtSgst" })
                    </div>
                    @Html.HiddenFor(model => model.SgstPercentage, new { @id = "hdnSgstPercentage" })
                </div>
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(m => m.Ugst, new { @class = "label" })
                    <div class="input">
                        @Html.TextBoxFor(model => model.Ugst, "0.00", new { @Class = "textlabel form-control numeric2", @id = "txtUgst" })
                    </div>
                    @Html.HiddenFor(model => model.UgstPercentage, new { @id = "hdnUgstPercentage" })
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(m => m.GstTotal, new { @class = "label" })
                    <div class="input">
                        @Html.TextBoxFor(model => model.GstTotal, "0.00", new { @Class = "textlabel form-control numeric2", @id = "txtGstTotal" })
                    </div>
                </div>
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(m => m.Amount, new { @class = "label" })
                    <div class="input">
                        @Html.TextBoxFor(model => model.Amount, "0.00", new { @Class = "textlabel form-control numeric2", @id = "txtTotalAmount" })
                    </div>
                </div>
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(m => m.NetAmount, new { @class = "label" })
                    <div class="input">
                        @Html.TextBoxFor(model => model.NetAmount, "0.00", new { @Class = "textlabel form-control numeric2", @id = "txtNetAmount" })
                    </div>
                </div>
                @Html.ValidationMessageFor(model => model.NetAmount)
            </div>
        </div>
        <div class="row">
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(model => model.TdsRate, new { @class = "label" })
                    <div class="input">
                        @Html.TextBoxFor(model => model.TdsRate, new { @class = "form-control numeric2", @id = "txtTdsRate" })
                    </div>
                    @Html.ValidationMessageFor(model => model.TdsRate)
                </div>
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(model => model.TdsAccountId, new { @class = "label" })
                    <div class="select">
                        @Html.DropDownListFor(model => model.TdsAccountId, new SelectList(ViewBag.TdsList, "Value", "Name"), "Select TDS Section", new { @class = "form-control", @id = "ddlTdsSection" })
                        <i></i>
                    </div>
                    @Html.ValidationMessageFor(model => model.TdsAccountId)
                </div>
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(model => model.TdsAmount, new { @class = "label" })
                    <div class="input">
                        @Html.TextBoxFor(model => model.TdsAmount, new { @class = "form-control textlabel numeric2", @id = "txtTdsAmount" })
                    </div>
                    @Html.ValidationMessageFor(model => model.TdsAmount)
                </div>
            </div>
        </div>
        <div class="row" id="divPaymentDetail">
            <div class="col-sm-12">
                <div class="form-group">
                    @Html.Partial("Payment", new PaymentControl() { PaymentDetails = new Payment() { EnableOnAccount = true} })
                </div>
            </div>
        </div>
        <div class="row" id="divReceiptDetail">
            <div class="col-sm-12">
                <div class="form-group">
                    @Html.Partial("Receipt", new ReceiptControl() { ReceiptDetails = new Receipt() { EnableOnAccount = true, EnableBothReceipt = true } })
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-3">
                <div class="form-group">
                    @Html.LabelFor(model => model.VendorInvoiceDocumentName, new { @class = "label" })
                    <div class="input prepend-big-btn">
                        <label class="icon-right" for="prepend-big-btn">
                            <i class="fa fa-download"></i>
                        </label>
                        <div class="file-button">
                            Browse
                            <input type="file" id="fuVendorInvoiceDocumentAttachment" name="VendorInvoiceAttachment" class="form-control" onchange="document.getElementById('prepend-big-btn').value = this.value;" />
                        </div>
                        <input class="form-control" type="text" id="prepend-big-btn" readonly="" placeholder="no file selected">
                    </div>
                </div>
            </div>
        </div>
        <div class="row form-buttons">
            <div class="col-sm-offset-5 col-sm-7">
                <input type="submit" value="Submit" class="btn btn-success primary-btn" id="btnSubmit" />
            </div>
        </div>
    </div>
}

<script>
    var selectedCodeType = "2", ownerType = 2, locationId;
    var hdnCompanyId, rdManualDebitVoucher, rdManualCreditVoucher, hdnAccountingLocationId, txtAccountingLocationCode, lblCompanyGstTinNo, hdnGstTinNo, hdnCompanyGstId, hdnCompanyGstStateId, hdnCodeId, txtCode, lblCode, dvOther, txtPartyName, lblPartyName, ddlPartyGstId, hdnPartyGstStateId, lblGstTinNo, hdnIsRegistered;
    var txtGstTotal;
    var employeeMasterUrl, customerMasterUrl, gstMasterUrl, stateMasterUrl, accountMasterUrl, hsnMasterUrl, vendorMasterUrl, vehicleMasterUrl, driverMasterUrl, docketUrl, tripsheetUrl, thcUrl;
    var isState, interState, isRegistered = false, isRegistered = false, chkIsCostCenterApplicable;
    var rdCodeTypeCustomer, rdCodeTypeVendor,rdCodeTypeEmployee,rdCodeTypeDriver,rdCodeTypeVehicle,rdCodeTypeOther;
    $(document).ready(function () {
        SetPageLoad('Credit Debit', 'Voucher', '', '', '');
        InitObjects();
        AttachEvents();
    });

    function InitObjects() {
        hdnCompanyId = $('#hdnCompanyId');
        rdManualDebitVoucher = $('#rdManualDebitVoucher');
        rdManualCreditVoucher = $('#rdManualCreditVoucher');
        hdnAccountingLocationId = $('#hdnAccountingLocationId');
        txtAccountingLocationCode = $('#txtAccountingLocationCode');
        lblCompanyGstTinNo = $('#lblCompanyGstTinNo');
        hdnGstTinNo = $('#hdnGstTinNo');
        hdnCompanyGstId = $('#hdnCompanyGstId');
        hdnCompanyGstStateId = $('#hdnCompanyGstStateId');
        hdnCodeId = $('#hdnCodeId');
        txtCode = $('#txtCode');
        lblCode = $('#lblCode');
        dvOther = $('#dvOther');
        txtPartyName = $('#txtPartyName');
        lblPartyName = $('#lblPartyName');
        ddlPartyGstId = $('#ddlPartyGstId');
        hdnPartyGstStateId = $('#hdnPartyGstStateId');
        txtGstTotal = $('#txtGstTotal');
        lblGstTinNo = $('#lblGstTinNo');
        hdnIsRegistered = $('#hdnIsRegistered');
        chkIsCostCenterApplicable = $('#chkIsCostCenterApplicable');
        locationId = '@SessionUtility.LoginLocationId';
        employeeMasterUrl = '@Url.Action("", "Employee", new { Area = "Master" })';
        customerMasterUrl = '@Url.Action("", "Customer", new { Area = "Master" })';
        gstMasterUrl = '@Url.Action("", "Gst", new { Area = "Master" })';
        stateMasterUrl = '@Url.Action("", "State", new { Area = "Master" })';
        accountMasterUrl = '@Url.Action("", "Account", new { Area = "Master" })';
        hsnMasterUrl = '@Url.Action("", "Hsn", new { Area = "Master" })';
        vendorMasterUrl = '@Url.Action("", "Vendor", new { Area = "Master" })';
        vehicleMasterUrl = '@Url.Action("", "Vehicle", new { Area = "Master" })';
        driverMasterUrl = '@Url.Action("", "Driver", new { Area = "Master" })';
        docketUrl = '@Url.Action("", "Docket", new { Area = "Operation" })';
        tripsheetUrl = '@Url.Action("", "Tripsheet", new { Area = "FMS" })';
        thcUrl = '@Url.Action("", "THC", new { Area = "Operation" })';
        rdCodeTypeCustomer=$('#rdCodeTypeCustomer');
        rdCodeTypeVendor = $('#rdCodeTypeVendor');
        rdCodeTypeEmployee = $('#rdCodeTypeEmployee');
        rdCodeTypeDriver = $('#rdCodeTypeDriver');
        rdCodeTypeVehicle = $('#rdCodeTypeVehicle');
        rdCodeTypeOther = $('#rdCodeTypeOther');
        $('#dvTdsDetails').hide();
    }

    function AttachEvents() {
        $('#rdManualDebitVoucher,#rdManualCreditVoucher').change(OnVoucherTypeChange);
        OnVoucherTypeChange();
        LocationAutoComplete('txtAccountingLocationCode', 'hdnAccountingLocationId');
        txtAccountingLocationCode.blur(function () {
            // IsLocationCodeExist(txtAccountingLocationCode, hdnAccountingLocationId, 'Location'); GetGstTinNo();
            IsLocationCodeExist(txtAccountingLocationCode, hdnAccountingLocationId, 'Location'); 

        });
        //GetGstTinNo();
        $('[id*="rdCodeType"]').each(function () { $(this).click(function () { selectedCodeType = $(this).val(); OnCodeTypeChange(); }); });
        OnCodeTypeChange();
        CheckIsStateOrUnionTerritory();
        txtCode.blur(function () { return CheckIsValid(txtCode, hdnCodeId, lblCode); });
        ddlPartyGstId.change(OnGstStateChange);
        $('#txtTdsRate').blur(CalculateAmount);
        InitGrid('dtAccountDetailList', false, 16, InitAccountDetailTable, false);
        ResizeTable('dtAccountDetailList', [[0, '100px'], [1, '100px'], [6, '250px']]);
        $('#txtCommanNarration').blur(SetCommanNarration);
        $('#ddlTdsSection').change(OnTdsSectionChange);
        chkIsCostCenterApplicable.change(OnCostCenterChange);
        OnCostCenterChange();
        rdCodeTypeCustomer.change(OnCodeTypeChangeYN);
        rdCodeTypeVendor.change(OnCodeTypeChangeYN);
        rdCodeTypeEmployee.change(OnCodeTypeChangeYN);
        rdCodeTypeDriver.change(OnCodeTypeChangeYN);
        rdCodeTypeVehicle.change(OnCodeTypeChangeYN);
        rdCodeTypeOther.change(OnCodeTypeChangeYN);
        OnCodeTypeChangeYN();
    }

    function OnCodeTypeChangeYN() {
        if (rdCodeTypeCustomer.IsChecked || rdCodeTypeVendor.IsChecked) {
            chkIsOnAccount.readOnly(false);
            chkIsOnAccount.enable();
        }
        else {
            chkIsOnAccount.readOnly;
            chkIsOnAccount.disable();
            chkIsOnAccount.check(false);
        }

    }

    function OnVoucherTypeChange() {
        $('#divPaymentDetail').showHide(rdManualDebitVoucher.IsChecked);
        $('#divReceiptDetail').showHide(rdManualCreditVoucher.IsChecked);
        $('#txtReceiptAmountApplicable').enable(rdManualCreditVoucher.IsChecked);
        $('#ddlReceiptTdsAccount').enable(rdManualCreditVoucher.IsChecked);
        CalculateAmount();
    }

    function GetGstTinNo() {
        if (hdnAccountingLocationId.val() != 0 && hdnAccountingLocationId.val() != '') {
            var requestData = { locationId: hdnAccountingLocationId.val(), ownerType: 1 };
            AjaxRequestWithPostAndJson(gstMasterUrl + '/GetGstDetailByLocationIdAndOwnerType', JSON.stringify(requestData), function (result) {
                if (!IsObjectNullOrEmpty(result)) {
                    lblCompanyGstTinNo.text(result.GstTinNo);
                    hdnGstTinNo.val(result.GstTinNo);
                    hdnCompanyGstId.val(result.GstId);
                    hdnCompanyGstStateId.val(result.StateId);
                    if (result.GstTinNo == '') {
                        ShowMessage('GST is not registered for ' + txtAccountingLocationCode.val() + ' Location');
                        txtAccountingLocationCode.val('');
                        hdnAccountingLocationId.val(0);
                        txtAccountingLocationCode.focus();
                    }
                }
                else
                {
                    ShowMessage('GST is not registered for ' + '@SessionUtility.CompanyName');
                    $('.widget-wrap').hide();
                    return false;
                }
            }, ErrorFunction, false);
            return false;
        }
        else {
            lblCompanyGstTinNo.text('');
            hdnGstTinNo.val('');
            hdnCompanyGstStateId.val(0);
        }
    }

    function CheckIsStateOrUnionTerritory() {
        if (hdnCompanyGstStateId.val() != '') {
            var requestData = { stateId: hdnCompanyGstStateId.val() };
            AjaxRequestWithPostAndJson(stateMasterUrl + '/CheckIsStateOrUnionTerritory', JSON.stringify(requestData), function (result) {
                isState = result;
            }, ErrorFunction, false);
        }
    }


    function OnGstStateChange() {
        if (ddlPartyGstId.val() != '' && ddlPartyGstId.val() != 0 && hdnIsRegistered.val() == 'true') {
            var requestData = { ownerType: 1, ownerId: loginCompanyId , stateId: ddlPartyGstId.val() };
            AjaxRequestWithPostAndJson(gstMasterUrl + '/GetGstDetailByOwnerAndState', JSON.stringify(requestData), function (result) {
                if (!IsObjectNullOrEmpty(result)) {
                    hdnPartyGstStateId.val(result.StateId);
                    lblGstTinNo.text(result.GstTinNo);
                }
                else {
                    hdnPartyGstStateId.val(0);
                    lblGstTinNo.text('');
                }
            }, ErrorFunction, false);
        }
        else {
            lblGstTinNo.text('');
            hdnPartyGstStateId.val(ddlPartyGstId.val());
        }
        interState = hdnPartyGstStateId.val() == hdnCompanyGstStateId.val() ? false : true;
        CalculateAmount();
    }

    function OnCostCenterChange() {
        $('#thCostCenterType').showHide(chkIsCostCenterApplicable.IsChecked);
        $('#thCostCenter').showHide(chkIsCostCenterApplicable.IsChecked);
        $('[id*="ddlCostCenterType"]').each(function () {
            var ddlCostCenterType = $(this);
            var hdnCostCenterId = $('#' + this.Id.replace('ddlCostCenterType', 'hdnCostCenterId'));
            var txtCostCenter = $('#' + this.Id.replace('ddlCostCenterType', 'txtCostCenter'));
            var tdCostCenterType = $('#' + this.Id.replace('ddlCostCenterType', 'tdCostCenterType'));
            var tdCostCenter = $('#' + this.Id.replace('ddlCostCenterType', 'tdCostCenter'));
            ddlCostCenterType.enable(chkIsCostCenterApplicable.IsChecked);
            txtCostCenter.enable(chkIsCostCenterApplicable.IsChecked);
            tdCostCenterType.showHide(chkIsCostCenterApplicable.IsChecked);
            tdCostCenter.showHide(chkIsCostCenterApplicable.IsChecked);
        });
    }

    function OnCodeTypeChange() {
        txtCode.val('');
        lblCode.text('');
        hdnCodeId.val('');
        txtPartyName.val('');
        ddlPartyGstId.empty();
        ddlPartyGstId.append($("<option></option>").val('').html('Select State'));
        ddlPartyGstId.val('');
        $('[id*="ddlSacId"]').val('');
        $('[id*="txtGstRate"]').val(0);
        $('[id*="txtGstAmount"]').val(0);
        $('[id*="txtGstCharged"]').val(0);
        $('[id*="txtTotalAmount"]').val(0);
        dvOther.hide();
        switch (selectedCodeType) {
            case "1":
                UserAutoComplete('txtCode', 'hdnCodeId');
                break;
            case "2":
                CustomerAutoComplete('txtCode', 'hdnCodeId');
                break;
            case "3":
                VendorAutoComplete('txtCode', 'hdnCodeId');
                break;
            case "5":
                DriverCodeAutoCompleteByLocation('txtCode', 'hdnCodeId');
                break;
            case "6":
                VehicleAutoComplete('txtCode', 'hdnCodeId');
                break;
            case "8":
                txtCode.autocomplete("destroy");
                break;
        }
    }

    function CheckIsValid(objCode, objHdnId, objLbl) {
        lblGstTinNo.text('');
        hdnPartyGstStateId.val('');
        $('[id*="ddlSacId"]').val('');
        $('[id*="txtGstRate"]').val(0);
        $('[id*="txtGstAmount"]').val(0);
        $('[id*="txtGstCharged"]').val(0);
        $('[id*="txtTotalAmount"]').val(0);
        switch (selectedCodeType) {
            case "1":
                
                ownerType = 1;
                IsUserCodeExist(objCode, objHdnId, objLbl);
                dvOther.hide();
                if (objCode.val() != '')
                    GetCompanyGstState(hdnCompanyId, ownerType);
                RemoveRequired(txtPartyName);
                txtPartyName.val(objLbl.text());
                break;
            case "2":
                
                ownerType = 2;
                IsCustomerCodeExist(objCode, objHdnId, objLbl);
                dvOther.showHide(objHdnId.val() == 1);
                GetGstState(objHdnId, ownerType);
                lblPartyName.text("Customer");
                if (objHdnId.val() != 1 && objHdnId.val() != '') {
                    RemoveRequired(txtPartyName);
                    txtPartyName.val(objLbl.text());
                }
                else {
                    txtPartyName.val('');
                    AddRequired(txtPartyName, 'Please enter Customer');
                }
                break;
            case "3":
                
                ownerType = 4;
                IsVendorCodeExist(objCode, objHdnId, objLbl);
                dvOther.showHide(objHdnId.val() == 1);
                GetGstState(objHdnId, ownerType);
                lblPartyName.text("Vendor");
                if (objHdnId.val() != 1 && objHdnId.val() != '') {
                    RemoveRequired(txtPartyName);
                    txtPartyName.val(objLbl.text());
                }
                else {
                    txtPartyName.val('');
                    AddRequired(txtPartyName, 'Please enter Vendor');
                }
                break;
            case "5":
                
                ownerType = 1;
                IsDriverCodeExistByLocation(objCode, objHdnId, objLbl);
                dvOther.showHide(objHdnId.val() == 1);
                lblPartyName.text("Driver");
                if (objCode.val() != '')
                    GetCompanyGstState(hdnCompanyId, ownerType);
                if (objHdnId.val() != 1 && objHdnId.val() != '') {
                    RemoveRequired(txtPartyName);
                    //txtPartyName.val(objCode.val());
                    txtPartyName.val(objLbl.text());
                }
                else {
                    txtPartyName.val('');
                    AddRequired(txtPartyName, 'Please enter Driver');
                }
                break;
            case "6":
                
                ownerType = 1;
                IsVehicleNoExist(objCode, objHdnId);
                dvOther.showHide(objHdnId.val() == 1);
                lblPartyName.text("Vehicle");
                if (objCode.val() != '')
                    GetCompanyGstState(hdnCompanyId, ownerType);
                if (objHdnId.val() != 1 && objCode.val() != '') {
                    RemoveRequired(txtPartyName);
                    txtPartyName.val(objCode.val());
                }
                else {
                    txtPartyName.val('');
                    AddRequired(txtPartyName, 'Please enter Vehicle');
                }
                break;
            case "8":
                ownerType = 1;
                dvOther.hide();
                if (objCode.val() != '')
                    GetCompanyGstState(hdnCompanyId, ownerType);
                txtPartyName.val(objCode.val());
                break;
        }

        SetPaymentPartyTypeAndParty(selectedCodeType, objHdnId.val());
		SetReceiptPartyTypeAndParty(selectedCodeType, objHdnId.val());
    }

    function CheckValidCustomerCode(txtCustomerCode, hdnCustomerId) {
        if (txtCustomerCode.val() != "") {
            var requestData = { customerCode: txtCustomerCode.val().split(':')[0].trim() };
            AjaxRequestWithPostAndJson(customerMasterUrl + '/IsCustomerCodeExist', JSON.stringify(requestData), function (result) {
                if (result.Value > 0) {
                    hdnCustomerId.val(result.Value);
                    txtCustomerCode.val(result.Name + ' : ' + result.Description);
                }
                else {
                    ShowMessage('Customer is not exist');
                    txtCustomerCode.val('');
                    hdnCustomerId.val('');
                    txtCustomerCode.focus();
                }
            }, ErrorFunction, false);
        }
    }


    function GetCompanyGstState(objHdnId, ownerType) {
        if (objHdnId.val() != '' && objHdnId.val() != 0) {
            var requestData = { ownerType: ownerType, ownerId: objHdnId.val(), locationId: 0 };
            AjaxRequestWithPostAndJson(gstMasterUrl + '/GetStateListByOwnerTypeIdAndOwnerId', JSON.stringify(requestData), function (responseData) {
                if (responseData.length != 0) {
                    BindDropDownList(ddlPartyGstId.Id, responseData, 'Value', 'Name', '', 'Select GST State');
                    isRegistered = true;
                    hdnIsRegistered.val(true);
                }
            }, ErrorFunction, false);
        }
        else {
            ddlPartyGstId.empty();
            ddlPartyGstId.append($("<option></option>").val('').html('Select State'));
            ddlPartyGstId.val('');
            hdnIsRegistered.val(false);
        }
    }

    function GetGstState(objHdnId, ownerType) {
        if (objHdnId.val() != 1 && objHdnId.val() != 0) {
            var requestData = { ownerType: ownerType, ownerId: objHdnId.val(), locationId: 0 };
            AjaxRequestWithPostAndJson(gstMasterUrl + '/GetStateListByOwnerTypeIdAndOwnerId', JSON.stringify(requestData), function (responseData) {
                if (responseData.length != 0) {
                    BindDropDownList(ddlPartyGstId.Id, responseData, 'Value', 'Name', '', 'Select GST State');
                    isRegistered = true;
                }
                else {
                    requestData = {};
                    AjaxRequestWithPostAndJson(stateMasterUrl + '/GetStateList', JSON.stringify(requestData), function (responseData) {
                        BindDropDownList(ddlPartyGstId.Id, responseData, 'Value', 'Name', '', 'Select State');
                    }, ErrorFunction, false);
                    isRegistered = false;
                }
                hdnIsRegistered.val(isRegistered);
            }, ErrorFunction, false);
        }
        else if (objHdnId.val() == 1) {
            requestData = {};
            AjaxRequestWithPostAndJson(stateMasterUrl + '/GetStateList', JSON.stringify(requestData), function (responseData) {
                BindDropDownList(ddlPartyGstId.Id, responseData, 'Value', 'Name', '', 'Select State');
            }, ErrorFunction, false);
            isRegistered = false;
            hdnIsRegistered.val(isRegistered);
        }
        else {
            ddlPartyGstId.empty();
            ddlPartyGstId.append($("<option></option>").val('').html('Select State'));
            ddlPartyGstId.val('');
            hdnIsRegistered.val(isRegistered);
        }
    }

    function SetCommanNarration() {
        $('[id*="txtNarration"]').val($('#txtCommanNarration').val());
    }

    function InitAccountDetailTable() {
        $('[id*="txtAccountCode"]').each(function () {
            var txtAccountCode = $(this);
            var lblAccountDescription = $('#' + this.Id.replace('txtAccountCode', 'lblAccountDescription'));
            var hdnAccountId = $('#' + this.Id.replace('txtAccountCode', 'hdnAccountId'));
            var chkGstExempted = $('#' + this.Id.replace('txtAccountCode', 'chkGstExempted'));
            var chkTdsExempted = $('#' + this.Id.replace('txtAccountCode', 'chkTdsExempted'));
            var chkIsProduct = $('#' + this.Id.replace('txtAccountCode', 'chkIsProduct'));
            var ddlSacId = $('#' + this.Id.replace('txtAccountCode', 'ddlSacId'));
            var txtUnits = $('#' + this.Id.replace('txtAccountCode', 'txtUnits'));
            var txtAmount = $('#' + this.Id.replace('txtAccountCode', 'txtAmount'));
            var lblRcm = $('#' + this.Id.replace('txtAccountCode', 'lblRcm'));
            var hdnIsRcm = $('#' + this.Id.replace('txtAccountCode', 'hdnIsRcm'));
            var txtGstRate = $('#' + this.Id.replace('txtAccountCode', 'txtGstRate'));
            var txtGstAmount = $('#' + this.Id.replace('txtAccountCode', 'txtGstAmount'));
            var txtGstCharged = $('#' + this.Id.replace('txtAccountCode', 'txtGstCharged'));
            var txtTotalAmount = $('#' + this.Id.replace('txtAccountCode', 'txtTotalAmount'));
            var ddlCostCenterType = $('#' + this.Id.replace('txtAccountCode', 'ddlCostCenterType'));
            var hdnCostCenterId = $('#' + this.Id.replace('txtAccountCode', 'hdnCostCenterId'));
            var txtCostCenter = $('#' + this.Id.replace('txtAccountCode', 'txtCostCenter'));
            var lblCostCenterId = $('#' + this.Id.replace('txtAccountCode', 'lblCostCenter'));

            txtUnits.disable();
            txtGstRate.readOnly();
            txtAccountCode.blur(function () {
                if (!CheckDuplicateInTable('dtAccountDetailList', 'txtAccountCode', 'Account Code', txtAccountCode)) return false;
                return Account.CheckValidAccountCode(txtAccountCode, hdnAccountId, lblAccountDescription);
            });
            
            Account.AccountAutoComplete(txtAccountCode.Id, hdnAccountId.Id);
                        
            txtCostCenter.blur(function () { return CheckIsCostCenterValid(ddlCostCenterType, txtCostCenter, hdnCostCenterId, lblCostCenterId); });
            ddlCostCenterType.change(function () { OnCostCenterTypeChange(ddlCostCenterType, txtCostCenter, hdnCostCenterId); });

            chkIsProduct.change(function () {
                txtUnits.val(0);
                txtUnits.enable(chkIsProduct.IsChecked);
                txtGstRate.readOnly(chkIsProduct.IsChecked);
                lblRcm.text("No");
                if (chkIsProduct.IsChecked) {
                    AddRequired(txtUnits, 'Please select Units');
                    AddRequired(txtGstRate, 'Please select GST Rate');
                    AddRange(txtUnits, 'Please enter Units', 1);
                    AddRange(txtGstRate, 'Please enter GST', 0.001);
                    var requestData = {};
                    AjaxRequestWithPostAndJson(hsnMasterUrl + '/GetHsnList', JSON.stringify(requestData), function (responseData) {
                        if (responseData.length != 0) {
                            BindDropDownList(ddlSacId.Id, responseData, 'Value', 'Name', '', 'Select');
                        }
                    }, ErrorFunction, false);
                    hdnIsRcm.val(false);
                    lblRcm.text("No");
                    RemoveRequired(ddlSacId);
                    AddRequired(ddlSacId, 'Please select HSN');
                }
                else {
                    RemoveRequired(ddlSacId);
                    AddRequired(ddlSacId, 'Please select SAC');
                    RemoveRequired(txtUnits);
                    RemoveRequired(txtGstRate);
                    RemoveRange(txtUnits);
                    RemoveRange(txtGstRate);
                    var requestData = {};
                    AjaxRequestWithPostAndJson(gstMasterUrl + '/GetList', JSON.stringify(requestData), function (responseData) {
                        if (responseData.length != 0) {
                            BindDropDownList(ddlSacId.Id, responseData, 'Value', 'Name', '', 'Select');
                        }
                    }, ErrorFunction, false);
                }
                CalculateAmount();
            });

            chkGstExempted.change(OnGstExemptedChange);
            chkTdsExempted.change(OnTdsExemptedChange);
            ddlSacId.change(function () {
                var requestData = { id: ddlSacId.val() };
                AjaxRequestWithPostAndJson(gstMasterUrl + '/GetDetailById', JSON.stringify(requestData), function (result) {
                    if (result != null) txtGstRate.val(result.GstRate);
                    if (selectedCodeType == '1' || selectedCodeType == '5' || selectedCodeType == '6' || selectedCodeType == '8') {
                        lblRcm.text("No");
                        isRcm = false;
                    }
                    else if (!chkIsProduct.IsChecked) {
                        if (!isRegistered) {
                            lblRcm.text("No");
                            hdnIsRcm.val(false);
                        }
                        else {
                            lblRcm.text(result.IsRcm == true ? "Yes" : "No");
                            hdnIsRcm.val(result.IsRcm);
                        }
                    }
                }, ErrorFunction, false);
                CalculateAmount();
            });
            txtAmount.blur(CalculateAmount);
            txtGstRate.blur(CalculateAmount);
        });
    }

    var Account = {
        CheckValidAccountCode: function (txtAccountCode, hdnAccountId, lblAccountDescription) {
            if (txtAccountCode.val() != '') {
                
                var requestData = { accountCode: txtAccountCode.val().split(':')[0].trim() };
                AjaxRequestWithPostAndJson(accountMasterUrl + '/IsAccountCodeExist', JSON.stringify(requestData), function (result) {
                    if (IsObjectNullOrEmpty(result)) {
                        ShowMessage('Account is not exist');
                        txtAccountCode.focus();
                        txtAccountCode.val('');
                        hdnAccountId.val('');
                        lblAccountDescription.text('');
                    }
                    else {
                        if (rdManualCreditVoucher.IsChecked && rdCodeTypeCustomer.IsChecked) {
                            if (result.Name != 'CDA0001') {
                                ShowMessage('Please select billed debtors accounts CDA0001');
                                txtAccountCode.focus();
                                txtAccountCode.val('');
                                hdnAccountId.val('');
                                lblAccountDescription.text('');
                            }
                            else {
                                hdnAccountId.val(result.Value);
                                txtAccountCode.val(result.Name);
                                lblAccountDescription.text(result.Description);
                            }

                        }
                        else
                        {
                            hdnAccountId.val(result.Value);
                            txtAccountCode.val(result.Name);
                            lblAccountDescription.text(result.Description);
                        }
                        
                    }
                }, ErrorFunction, false);
            }
            else {
                hdnAccountId.val('');
                lblAccountDescription.text('');
            }
            return false;
        },
        AccountAutoComplete: function (txtAccountCodeId, hdnAccountId) {
            AutoComplete(txtAccountCodeId, accountMasterUrl + '/GetAccountAutoCompleteList', 'accountCode', 'l', 'l', 'l', 'd', '', hdnAccountId, '', '', true, '');
        }
    }

    function CheckIsCostCenterValid(objCostCenterType, objName, objHdnId, objLbl) {
        switch (objCostCenterType.val()) {
            case "1":
                CheckValidCustomerCode(objName, objHdnId);
                if (objHdnId.val() == 1) {
                    ShowMessage('Customer is not exist');
                    objName.val('');
                    objHdnId.val('');
                    objName.focus();
                }
                break;
            case "2":
                IsVendorCodeExist(objName, objHdnId, objLbl);
                if (objHdnId.val() == 1) {
                    ShowMessage('Vendor is not exist');
                    objName.val('');
                    objHdnId.val('');
                    objName.focus();
                }
                break;
            case "3":
                IsUserNameExist(objName, objHdnId);
                break;
            case "4":
                IsVehicleNoExist(objName, objHdnId);
                if (objHdnId.val() == 1) {
                    ShowMessage('Vehicle is not exist');
                    objName.val('');
                    objHdnId.val('');
                    objName.focus();
                }
                break;
            case "5":
                CheckValidDocketNo(objName, objHdnId);
                break;
            case "6":
                IsDriverNameExistByLocation(objName, objHdnId);
                if (objHdnId.val() == 1) {
                    ShowMessage('Driver is not exist');
                    objName.val('');
                    objHdnId.val('');
                    objName.focus();
                }
                break;
            case "7":
                IsLocationCodeExist(objName, objHdnId, 'Location');
                break;
            case "8":
                CheckValidTripsheetNo(objName, objHdnId);
                break;
            case "9":
                CheckValidThcNo(objName, objHdnId);
                break;
        }
    }

    function OnCostCenterTypeChange(ddlCostCenterType, txtCostCenter, hdnCostCenterId) {
        txtCostCenter.val('');
        hdnCostCenterId.val('');
        if (ddlCostCenterType.val() == 1) {
            CustomerAutoComplete(txtCostCenter.Id, hdnCostCenterId.Id)
            //AutoComplete(txtCostCenter.Id, customerMasterUrl + '/GetAutoCompleteCustomerList', 'customerName', 'l', 'l', 'l', 'd', '', hdnCostCenterId.Id, '', '', function () {
            //    return [{ Key: 'allowWalkin', Value: false }];
            //});
        }
        else if (ddlCostCenterType.val() == 2) {
            VendorAutoComplete(txtCostCenter.Id, hdnCostCenterId.Id);
            //AutoComplete(txtCostCenter.Id, vendorMasterUrl + '/GetAutoCompleteVendorList', 'vendorName', 'l', 'l', 'l', 'd', '', hdnCostCenterId.Id, '', '', function () {
            //    return [{ Key: 'allowMarket', Value: false }];
            //});
        }
        else if (ddlCostCenterType.val() == 3)
            UserAutoComplete(txtCostCenter.Id, hdnCostCenterId.Id);
        else if (ddlCostCenterType.val() == 4) {
            VehicleAutoComplete(txtCostCenter.Id, hdnCostCenterId.Id);
            //AutoComplete(txtCostCenter.Id, vehicleMasterUrl + '/GetAutoCompleteVehicleList', 'vehicleNo', 'l', 'l', 'l', 'd', '', hdnCostCenterId.Id, '', '', function () {
            //    return [{ Key: 'allowMarket', Value: false }];
            //});
        }
        else if (ddlCostCenterType.val() == 5)
            txtCostCenter.autocomplete("destroy");
        else if (ddlCostCenterType.val() == 6) {
            DriverAutoCompleteByLocation(txtCostCenter.Id, hdnCostCenterId.Id);
            //AutoComplete(txtCostCenter.Id, driverMasterUrl + '/GetAutoCompleteDriverList', 'driverName', 'l', 'l', 'l', 'd', '', hdnCostCenterId.Id, '', '', function () {
            //    return [{ Key: 'allowWalkIn', Value: false }];
            //});
        }
        else if (ddlCostCenterType.val() == 7)
            LocationAutoComplete(txtCostCenter.Id, hdnCostCenterId.Id);
        else if (ddlCostCenterType.val() == 8)
            txtCostCenter.autocomplete("destroy");
        else if (ddlCostCenterType.val() == 9)
            txtCostCenter.autocomplete("destroy");
    }

    function CheckValidDocketNo(txtDocketNo, hdnDocketId) {
        if (txtDocketNo.val() != '') {
            var requestData = { docketNo: txtDocketNo.val() };
            AjaxRequestWithPostAndJson(docketUrl + '/CheckValidDocketNo', JSON.stringify(requestData), function (result) {
                if (result.Value > 0) {
                    hdnDocketId.val(result.Value);
                    txtDocketNo.val(result.Name);
                }
                else {
                    ShowMessage(docketNomenclature + ' is not exist');
                    txtDocketNo.val('');
                    hdnDocketId.val('');
                    txtDocketNo.focus();
                }
            }, ErrorFunction, false);
        }
    }

    function CheckValidTripsheetNo(txtTripsheetNo, hdnTripsheetId) {
        if (txtTripsheetNo.val() != '') {
            var requestData = { tripsheetNo: txtTripsheetNo.val() };
            AjaxRequestWithPostAndJson(tripsheetUrl + '/CheckValidTripsheetNo', JSON.stringify(requestData), function (result) {
                if (result.Value > 0) {
                    hdnTripsheetId.val(result.Value);
                    txtTripsheetNo.val(result.Name);
                }
                else {
                    ShowMessage('Tripsheet is not exist');
                    txtTripsheetNo.val('');
                    hdnTripsheetId.val('');
                    txtTripsheetNo.focus();
                }
            }, ErrorFunction, false);
        }
    }

    function CheckValidThcNo(txtThcNo, hdnThcId) {
        if (txtThcNo.val() != '') {
            var requestData = { thcNo: txtThcNo.val() };
            AjaxRequestWithPostAndJson(thcUrl + '/CheckValidThcCode', JSON.stringify(requestData), function (result) {
                if (result.Value > 0) {
                    hdnThcId.val(result.Value);
                    txtThcNo.val(result.Name);
                }
                else {
                    ShowMessage('THC is not exist');
                    txtThcNo.val('');
                    hdnThcId.val('');
                    txtThcNo.focus();
                }
            }, ErrorFunction, false);
        }
    }

    function OnGstExemptedChange() {
        var selectedDocumentList = [];
        $('[id*="chkGstExempted"]').each(function () {
            var chkGstExempted = $(this);
            if (chkGstExempted.IsChecked)
                selectedDocumentList.push($('#' + chkGstExempted.Id).val());
        });
        $('#dvDocumentDetails').showHide(selectedDocumentList.length != 0);
        if (selectedDocumentList.length != 0)
            AddRequired($('#ddlGstExemptedCategory'), 'Please select GST Exempted Category');
        else
            RemoveRequired($('#ddlGstExemptedCategory'));
        CalculateAmount();
    }

    function OnTdsExemptedChange() {
        var isTds = false;
        $('[id*="chkTdsExempted"]').each(function () {
            var chkTdsExempted = $(this);
            if (!chkTdsExempted.IsChecked)
                isTds = true;
        });
        if (!isTds) {
            RemoveRequired($('#ddlTdsSection'));
            RemoveRange($('#txtTdsRate'));
            $('#txtTdsRate').val(0);
            $('#ddlTdsSection').val(0);
            $('#txtTdsAmount').val(0);
        }
        else {
            AddRequired($('#ddlTdsSection'), 'Please select TDS Section');
            AddRange($('#txtTdsRate'), 'Please enter TDS Rate between 0 to 99.99', 0.001, 99.99);
        }
        $('#txtTdsRate').readOnly(!isTds);
        $('#ddlTdsSection').enable(isTds);
        $('#ddlReceiptTdsAccount').val($('#ddlTdsSection').val());
        CalculateAmount();
    }

    function OnTdsSectionChange() {
        $('#ddlReceiptTdsAccount').val($('#ddlTdsSection').val());
    }

    function CalculateAmount() {
        var isTdsExempted = false, isGstExempted = false;
        var subTotal = 0, totalGstCharged = 0, totalGstRate = 0, totalBillAmount = 0, totalTdsApplicableAmount = 0;
        $('[id*="txtAmount"]').each(function () {
            var txtAmount = $(this);
            var txtGstRate = $('#' + this.Id.replace('txtAmount', 'txtGstRate'));
            var hdnIsRcm = $('#' + this.Id.replace('txtAmount', 'hdnIsRcm'));
            var txtGstAmount = $('#' + this.Id.replace('txtAmount', 'txtGstAmount'));
            var txtGstCharged = $('#' + this.Id.replace('txtAmount', 'txtGstCharged'));
            var txtTotalAmount = $('#' + this.Id.replace('txtAmount', 'txtTotalAmount'));
            var chkTdsExempted = $('#' + this.Id.replace('txtAmount', 'chkTdsExempted'));
            var chkGstExempted = $('#' + this.Id.replace('txtAmount', 'chkGstExempted'));
            if (txtAmount.val() != '') {
                subTotal = subTotal + parseFloat(txtAmount.val());
                txtGstAmount.val(((parseFloat(txtAmount.val()) * parseFloat(txtGstRate.val())) / 100));
                if (hdnIsRcm.val() == "false" && !chkGstExempted.IsChecked) {
                    txtGstCharged.val(txtGstAmount.val());
                    totalGstRate = totalGstRate + parseFloat(txtGstRate.val());
                }
                else
                    txtGstCharged.val(0);
                totalGstCharged = totalGstCharged + parseFloat(txtGstCharged.val());
                if (chkGstExempted.IsChecked)
                    txtTotalAmount.val(parseFloat(txtAmount.val()));
                else
                    txtTotalAmount.val(parseFloat(txtAmount.val()) + parseFloat(txtGstCharged.val()));
                totalBillAmount = totalBillAmount + parseFloat(txtTotalAmount.val());
            }
            if (chkTdsExempted.IsChecked)
                isTdsExempted = true;
            else
                totalTdsApplicableAmount = totalTdsApplicableAmount + parseFloat(txtAmount.val());

        });
        $('#txtSubTotal').val(subTotal);
        $('#txtTotalAmount').val(totalBillAmount);

        txtGstTotal.val(totalGstCharged);
        if (totalGstCharged != 0) {
            if (interState) {
                $('#txtIgst').val(totalGstCharged);
                $('#txtSgst').val(0);
                $('#txtCgst').val(0);
                $('#txtUgst').val(0);
                $('#hdnIgstPercentage').val(totalGstRate);
                $('#hdnSgstPercentage').val(0);
                $('#hdnCgstPercentage').val(0);
                $('#hdnUgstPercentage').val(0);
            }
            else if (isState) {
                $('#txtIgst').val(0);
                $('#txtSgst').val(totalGstCharged / 2);
                $('#txtCgst').val(totalGstCharged / 2);
                $('#txtUgst').val(0);
                $('#hdnIgstPercentage').val(0);
                $('#hdnSgstPercentage').val(totalGstRate / 2);
                $('#hdnCgstPercentage').val(totalGstRate / 2);
                $('#hdnUgstPercentage').val(0);
            }
            else if (!isState) {
                $('#txtIgst').val(0);
                $('#txtUgst').val(totalGstCharged / 2);
                $('#txtCgst').val(totalGstCharged / 2);
                $('#txtSgst').val(0);
                $('#hdnIgstPercentage').val(0);
                $('#hdnUgstPercentage').val(totalGstRate / 2);
                $('#hdnCgstPercentage').val(totalGstRate / 2);
                $('#hdnSgstPercentage').val(0);
            }
        }
        else {
            $('#txtIgst').val(0);
            $('#txtSgst').val(0);
            $('#txtCgst').val(0);
            $('#txtUgst').val(0);
            $('#hdnIgstPercentage').val(0);
            $('#hdnSgstPercentage').val(0);
            $('#hdnCgstPercentage').val(0);
            $('#hdnUgstPercentage').val(0);
        }

        $('#txtTdsAmount').val((totalTdsApplicableAmount * parseFloat($('#txtTdsRate').val())) / 100);
        $('#txtNetAmount').val(totalBillAmount - parseFloat($('#txtTdsAmount').val()));
        if (!rdManualDebitVoucher.IsChecked) {
            SetReceiptAmount($('#txtNetAmount').val(), $('#txtTdsAmount').val());
            SetPaymentAmount(0);
        }
        else {
            SetReceiptAmount(0);
            SetPaymentAmount($('#txtNetAmount').val());
        }
        if (rdManualCreditVoucher.IsChecked && !isTdsExempted)
            $('#ddlReceiptTdsAccount').val($('#ddlTdsSection').val());
        $('#txtReceiptAmountApplicable').enable(!rdManualDebitVoucher.IsChecked);
    }
</script>
