@model IEnumerable<CodeLock.Models.CustomerContract>
@{
    ViewBag.Title = "Customer Contract List";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="widget-wrap material-table-widget">
    <table id="dtCustomerContract">
        <thead>
            <tr>
                <th>
                    @Html.DisplayNameFor(model => model.ManualContractId)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.CustomerName)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.StartDate)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.EndDate)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Paybas)
                </th>
                <th data-hide="phone">
                    @Html.DisplayNameFor(model => model.IsActive)
                </th>
                <th class="td-center" data-sort-ignore="true" data-hide="phone">Action</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.ManualContractId)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.CustomerCode) : @Html.DisplayFor(modelItem => item.CustomerName)
                    </td>
                    <td>
                        @item.StartDate.ToDisplayDate()
                    </td>
                    <td>
                        @item.EndDate.ToDisplayDate()
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Paybas)
                    </td>
                    <td>
                        @Html.Label("", item.IsActive == true ? "Yes" : "No", new { @class = item.IsActive == true ? "label label-success" : "label label-default" })
                    </td>
                    <td class="td-center">
                        <div class="btn-toolbar" role="toolbar">
                            <div class="btn-group" role="group">
                                @{var contractId = item.ContractId;}
                                <a class="btn btn-default btn-sm m-user-edit" href="@Url.Action("StepSelection", new { id = item.ContractId, isCustomerContract =true})"><span class="zmdi zmdi-edit"></span></a>
                                <a class="btn btn-default btn-sm m-user-edit" href="@Url.Action("Details", new { id = item.ContractId })"><span class="fa fa-file"></span></a>
                                <a class="btn btn-default btn-sm m-user-edit" onclick="return ViewReport(@contractId);"><span class="glyphicon glyphicon-eye-open"></span></a>

                                @*<button onclick="return ViewReport(@contractId);" class="btn btn-primary btn-xs dt-edit">
                                        <span class="glyphicon glyphicon-eye-open"></span>
                                    </button>*@
                            </div>
                        </div>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>


<script>
    var txtCustomerCode, hdnCustomerId, lblCustomerName;
    var isCustomerContract, customerId;
    $(document).ready(function () {
        @*SetPageLoad('Customer Contract', 'List', 'filter', 'Add New', '@Url.Action("Insert")');*@
        LoadDataTable('dtCustomerContract', true, true, true);
        InitCustomerContract();
    });

    function ViewReport(contractId) {
        return ShowViewPrint('@ModuleHelper.CustomerContract', contractId);
    }

    function InitCustomerContract() {
        isCustomerContract = GetUrlValue()["isCustomerContract"];
        customerId = GetUrlValue()["customerId"];
        if (isCustomerContract == "false")
            SetPageLoad('Vendor Contract', 'List', 'filter', 'Add New', 'javascript:ValidateCustomerContractAddNew();');
        else {
            SetPageLoad('Customer Contract', 'List', 'filter', 'Add New', 'javascript:ValidateCustomerContractAddNew();', 'Copy Contract', 'javascript:ValidateCustomerContractCopy();');
        }
    }

    function ValidateCustomerContractAddNew() {
        window.location.href = '@Url.Action("Insert","CustomerContract")?customerId=' + (isCustomerContract == "false" ? customerId : 0) + '&isCustomerContract=' + (isCustomerContract == "false" ? "false" : "true");
        return false;
    }

    function ValidateCustomerContractCopy() {
        window.location.href = '@Url.Action("CopyContract","CustomerContract")?customerId=' + (isCustomerContract == "false" ? customerId : 0) + '&isCustomerContract=' + (isCustomerContract == "false" ? "false" : "true");
        return false;
    }
</script>
